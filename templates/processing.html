<!DOCTYPE html>
<html>
<head>
    <title>Processing - MBR Automation Agent</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; text-align: center; }
        h1 { color: #232f3e; }
        .progress-container { margin: 40px 0; }
        .progress-bar { 
            width: 100%; height: 30px; background: #e0e0e0; 
            border-radius: 15px; overflow: hidden; 
        }
        .progress-fill { 
            height: 100%; background: #ff9900; 
            transition: width 0.3s ease; 
            display: flex; align-items: center; justify-content: center;
            color: white; font-weight: bold;
        }
        .status { margin: 20px 0; font-size: 18px; color: #666; }
        .spinner { 
            border: 4px solid #f3f3f3; border-top: 4px solid #ff9900;
            border-radius: 50%; width: 40px; height: 40px;
            animation: spin 1s linear infinite; margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <h1>Processing Your MBR Presentation</h1>
    
    <div class="spinner"></div>
    
    <div class="status" id="status">Initializing...</div>
    
    <div class="progress-container">
        <div class="progress-bar">
            <div class="progress-fill" id="progress" style="width: 0%;">0%</div>
        </div>
    </div>
    
    <script>
        function checkProgress() {
            fetch('/progress')
                .then(response => response.json())
                .then(data => {
                    const percent = Math.round((data.current / data.total) * 100);
                    document.getElementById('progress').style.width = percent + '%';
                    document.getElementById('progress').textContent = percent + '%';
                    document.getElementById('status').textContent = 
                        `Analyzing slide ${data.current} of ${data.total}...`;
                    
                    if (data.complete) {
                        window.location.href = '/download_page';
                    } else {
                        setTimeout(checkProgress, 1000);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    setTimeout(checkProgress, 2000);
                });
        }
        
        // Start checking progress
        setTimeout(checkProgress, 1000);
    </script>
</body>
</html>
